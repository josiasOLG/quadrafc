// ===================================
// IOS PWA SAFE AREA SUPPORT
// ===================================
// Adiciona padding-top quando a aplicação roda como PWA no iOS para compensar
// o espaço da URL bar que desaparece no modo standalone

body.ios-pwa {
  // Padding principal para compensar a ausência da URL bar no PWA iOS
  padding-top: 44px !important; // Altura padrão da status bar no iOS
  
  // Para dispositivos com safe area (iPhone X e superiores)
  @supports (padding: max(0px)) {
    padding-top: max(44px, env(safe-area-inset-top)) !important;
  }
  
  // Ajustes específicos para iPad em modo PWA
  &.ios-pwa-ipad {
    padding-top: 24px !important;
    
    @supports (padding: max(0px)) {
      padding-top: max(24px, env(safe-area-inset-top)) !important;
    }
  }
  
  // Ajustes específicos para iPhone em modo PWA
  &.ios-pwa-iphone {
    // iPhones com notch (iPhone X, 11, 12, 13, 14, 15 Pro Max, etc.)
    @media screen and (min-device-width: 375px) and (max-device-width: 430px) and (-webkit-min-device-pixel-ratio: 3) {
      padding-top: 47px !important; // Altura maior para dispositivos com notch
      
      @supports (padding: max(0px)) {
        padding-top: max(47px, env(safe-area-inset-top)) !important;
      }
    }
    
    // iPhones sem notch (iPhone 6, 7, 8, SE, etc.)
    @media screen and (min-device-width: 320px) and (max-device-width: 414px) and (-webkit-min-device-pixel-ratio: 2) {
      padding-top: 44px !important;
      
      @supports (padding: max(0px)) {
        padding-top: max(44px, env(safe-area-inset-top)) !important;
      }
    }
  }
  
  // Garante altura mínima completa da viewport
  min-height: 100vh;
  min-height: -webkit-fill-available;
  
  // Evita scroll horizontal desnecessário
  overflow-x: hidden;
  
  // Aplicação suave da mudança de padding
  transition: padding-top 0.3s ease-in-out;
}

// Aplicação global de transição para mudanças de padding
body {
  transition: padding-top 0.3s ease-in-out;
}

// para evitar sobreposição com a status bar e safe area
body.ios-pwa {
  // Usa as variáveis CSS nativas do iOS para safe area
  padding-top: env(safe-area-inset-top);
  padding-top: constant(safe-area-inset-top); // Fallback para iOS < 11.2
  
  // Fallback para dispositivos que não suportam safe-area-inset-top
  @supports not (padding-top: env(safe-area-inset-top)) {
    padding-top: 44px; // Altura padrão da status bar no iOS
  }
  
  // Ajustes específicos para iPhone com notch/Dynamic Island
  &.ios-pwa-iphone {
    @supports not (padding-top: env(safe-area-inset-top)) {
      padding-top: 47px; // Altura maior para iPhones com notch
    }
  }
  
  // Ajustes específicos para iPad
  &.ios-pwa-ipad {
    @supports not (padding-top: env(safe-area-inset-top)) {
      padding-top: 24px; // Altura menor para iPad
    }
  }
}

// Adiciona suporte para landscape orientation
@media screen and (orientation: landscape) {
  body.ios-pwa {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    padding-left: constant(safe-area-inset-left);
    padding-right: constant(safe-area-inset-right);
  }
}

// ===================================
// PWA STATUS BAR FIX FOR iOS
// ===================================
:root {
  --status-bar-color: #1e3a8a;
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
}

// Aplicar para iOS PWA
body.ios-pwa {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

// Status bar overlay para iOS PWA
@supports (-webkit-touch-callout: none) {
  /* iOS only styles */
  .ios-pwa-status-bar-fix {
    padding-top: var(--safe-area-top);
    background-color: var(--status-bar-color);
  }

  /* Status bar overlay para manter a cor consistente */
  body.ios-pwa::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--safe-area-top);
    background-color: var(--status-bar-color);
    z-index: 10000;
    pointer-events: none;
  }

  /* Garantir que o conteúdo principal não seja coberto */
  body.ios-pwa .app-container,
  body.ios-pwa app-root {
    padding-top: var(--safe-area-top);
    min-height: calc(100vh - var(--safe-area-top) - var(--safe-area-bottom));
  }

  /* Header adjustments para iOS PWA */
  body.ios-pwa .main-header,
  body.ios-pwa .app-header,
  body.ios-pwa .header {
    padding-top: calc(var(--safe-area-top) + 1rem);
    background-color: var(--status-bar-color);
  }

  /* Tabbar adjustments para iOS PWA */
  body.ios-pwa .bottom-navigation,
  body.ios-pwa .tabbar,
  body.ios-pwa .bottom-tabs {
    padding-bottom: calc(var(--safe-area-bottom) + 0.5rem);
  }
}

// ===================================
// PWA iOS STATUS BAR
// ===================================
@media all and (display-mode: standalone) {
  body {
    background-color: #014473;
  }
}
